<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. JavaScript基础 | 离线笔记 · OfflineNotes</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="记录学习过程。">
    <link rel="preload" href="/assets/css/0.styles.69fafbdc.css" as="style"><link rel="preload" href="/assets/js/app.52c11373.js" as="script"><link rel="preload" href="/assets/js/3.8898b206.js" as="script"><link rel="preload" href="/assets/js/4.fadcc5fc.js" as="script"><link rel="preload" href="/assets/js/14.91686631.js" as="script"><link rel="preload" href="/assets/js/23.85ba7bbb.js" as="script"><link rel="prefetch" href="/assets/js/10.8419d590.js"><link rel="prefetch" href="/assets/js/100.c58e58e4.js"><link rel="prefetch" href="/assets/js/101.cfa6eb43.js"><link rel="prefetch" href="/assets/js/102.f17b28fa.js"><link rel="prefetch" href="/assets/js/103.db886074.js"><link rel="prefetch" href="/assets/js/104.0ad08b09.js"><link rel="prefetch" href="/assets/js/105.b9a5bf3b.js"><link rel="prefetch" href="/assets/js/106.241090cf.js"><link rel="prefetch" href="/assets/js/107.0ab153b7.js"><link rel="prefetch" href="/assets/js/108.98858447.js"><link rel="prefetch" href="/assets/js/109.51f40f28.js"><link rel="prefetch" href="/assets/js/11.a99d8bab.js"><link rel="prefetch" href="/assets/js/110.14cc5218.js"><link rel="prefetch" href="/assets/js/111.b3bd4839.js"><link rel="prefetch" href="/assets/js/112.52775991.js"><link rel="prefetch" href="/assets/js/113.54e484b5.js"><link rel="prefetch" href="/assets/js/114.4d9f509e.js"><link rel="prefetch" href="/assets/js/115.5b52d203.js"><link rel="prefetch" href="/assets/js/116.dc3d7742.js"><link rel="prefetch" href="/assets/js/117.9b3a87ec.js"><link rel="prefetch" href="/assets/js/118.f6f6d553.js"><link rel="prefetch" href="/assets/js/119.98fcfbca.js"><link rel="prefetch" href="/assets/js/12.62cc9e6d.js"><link rel="prefetch" href="/assets/js/120.17a6d627.js"><link rel="prefetch" href="/assets/js/121.ecedaf49.js"><link rel="prefetch" href="/assets/js/122.10584ba2.js"><link rel="prefetch" href="/assets/js/123.12ecd5cf.js"><link rel="prefetch" href="/assets/js/124.4f572e85.js"><link rel="prefetch" href="/assets/js/125.99485772.js"><link rel="prefetch" href="/assets/js/126.d8718e23.js"><link rel="prefetch" href="/assets/js/127.a1cd907a.js"><link rel="prefetch" href="/assets/js/128.300cb2b9.js"><link rel="prefetch" href="/assets/js/129.7ef73f74.js"><link rel="prefetch" href="/assets/js/13.2aee53fd.js"><link rel="prefetch" href="/assets/js/130.00f86b60.js"><link rel="prefetch" href="/assets/js/131.65ffbc63.js"><link rel="prefetch" href="/assets/js/132.59f9140e.js"><link rel="prefetch" href="/assets/js/133.cab75520.js"><link rel="prefetch" href="/assets/js/134.6b797776.js"><link rel="prefetch" href="/assets/js/135.51b55f6e.js"><link rel="prefetch" href="/assets/js/136.5c504697.js"><link rel="prefetch" href="/assets/js/137.81301191.js"><link rel="prefetch" href="/assets/js/138.122fd111.js"><link rel="prefetch" href="/assets/js/139.6e836c9b.js"><link rel="prefetch" href="/assets/js/140.89863fff.js"><link rel="prefetch" href="/assets/js/141.81df794e.js"><link rel="prefetch" href="/assets/js/142.5cc401f1.js"><link rel="prefetch" href="/assets/js/143.113d60aa.js"><link rel="prefetch" href="/assets/js/144.28eb401a.js"><link rel="prefetch" href="/assets/js/145.874151cd.js"><link rel="prefetch" href="/assets/js/146.de136a97.js"><link rel="prefetch" href="/assets/js/147.f4a0253e.js"><link rel="prefetch" href="/assets/js/148.902151d6.js"><link rel="prefetch" href="/assets/js/149.d80bbab8.js"><link rel="prefetch" href="/assets/js/15.7380c00f.js"><link rel="prefetch" href="/assets/js/150.6a4cbe37.js"><link rel="prefetch" href="/assets/js/151.0f5cc9a4.js"><link rel="prefetch" href="/assets/js/152.91ca2aca.js"><link rel="prefetch" href="/assets/js/153.7986cbdd.js"><link rel="prefetch" href="/assets/js/154.df2cc8d7.js"><link rel="prefetch" href="/assets/js/155.8f3e45bc.js"><link rel="prefetch" href="/assets/js/156.788c899d.js"><link rel="prefetch" href="/assets/js/157.0b0eaf83.js"><link rel="prefetch" href="/assets/js/158.1933c7b5.js"><link rel="prefetch" href="/assets/js/159.394d7c67.js"><link rel="prefetch" href="/assets/js/16.d1cfc090.js"><link rel="prefetch" href="/assets/js/160.81093a4b.js"><link rel="prefetch" href="/assets/js/161.bc84082e.js"><link rel="prefetch" href="/assets/js/162.e22fe0e9.js"><link rel="prefetch" href="/assets/js/163.a1948e65.js"><link rel="prefetch" href="/assets/js/164.3fe01713.js"><link rel="prefetch" href="/assets/js/165.a39cb79f.js"><link rel="prefetch" href="/assets/js/166.be2a3e9b.js"><link rel="prefetch" href="/assets/js/167.963d46f5.js"><link rel="prefetch" href="/assets/js/168.1540f47d.js"><link rel="prefetch" href="/assets/js/169.b58d35cc.js"><link rel="prefetch" href="/assets/js/17.9132f971.js"><link rel="prefetch" href="/assets/js/170.c2ff985b.js"><link rel="prefetch" href="/assets/js/171.d2054d66.js"><link rel="prefetch" href="/assets/js/172.acaefe5b.js"><link rel="prefetch" href="/assets/js/173.19cea2d3.js"><link rel="prefetch" href="/assets/js/174.e3b20ab2.js"><link rel="prefetch" href="/assets/js/175.7a756d56.js"><link rel="prefetch" href="/assets/js/176.c18f44e2.js"><link rel="prefetch" href="/assets/js/177.eb348831.js"><link rel="prefetch" href="/assets/js/178.054d8fc7.js"><link rel="prefetch" href="/assets/js/179.a049357c.js"><link rel="prefetch" href="/assets/js/18.c01e2bfd.js"><link rel="prefetch" href="/assets/js/180.724b84a2.js"><link rel="prefetch" href="/assets/js/181.7978fbd0.js"><link rel="prefetch" href="/assets/js/182.05dec748.js"><link rel="prefetch" href="/assets/js/183.a0a45d4f.js"><link rel="prefetch" href="/assets/js/184.1f24ce4c.js"><link rel="prefetch" href="/assets/js/185.c34f0fb2.js"><link rel="prefetch" href="/assets/js/186.b6420517.js"><link rel="prefetch" href="/assets/js/187.8b501ede.js"><link rel="prefetch" href="/assets/js/188.411cafe7.js"><link rel="prefetch" href="/assets/js/189.fc55586e.js"><link rel="prefetch" href="/assets/js/19.c099fa2f.js"><link rel="prefetch" href="/assets/js/190.32482f90.js"><link rel="prefetch" href="/assets/js/191.11eda9f8.js"><link rel="prefetch" href="/assets/js/192.fff4661e.js"><link rel="prefetch" href="/assets/js/193.d82c4368.js"><link rel="prefetch" href="/assets/js/194.447b5660.js"><link rel="prefetch" href="/assets/js/195.9b5a2455.js"><link rel="prefetch" href="/assets/js/196.8f4b56c3.js"><link rel="prefetch" href="/assets/js/197.b0b41b19.js"><link rel="prefetch" href="/assets/js/198.93e9cc39.js"><link rel="prefetch" href="/assets/js/199.a10075f5.js"><link rel="prefetch" href="/assets/js/2.8fbc5bc2.js"><link rel="prefetch" href="/assets/js/20.21041e82.js"><link rel="prefetch" href="/assets/js/200.3bd7fd14.js"><link rel="prefetch" href="/assets/js/201.c9e1f27a.js"><link rel="prefetch" href="/assets/js/202.aa2228af.js"><link rel="prefetch" href="/assets/js/203.683e183b.js"><link rel="prefetch" href="/assets/js/204.a5cff18c.js"><link rel="prefetch" href="/assets/js/205.cb827513.js"><link rel="prefetch" href="/assets/js/206.c76bcc13.js"><link rel="prefetch" href="/assets/js/207.1493d968.js"><link rel="prefetch" href="/assets/js/208.df8b9630.js"><link rel="prefetch" href="/assets/js/209.127eadbd.js"><link rel="prefetch" href="/assets/js/21.0c085996.js"><link rel="prefetch" href="/assets/js/210.f82fefe6.js"><link rel="prefetch" href="/assets/js/211.20107c86.js"><link rel="prefetch" href="/assets/js/212.d1ae760b.js"><link rel="prefetch" href="/assets/js/213.692fa61d.js"><link rel="prefetch" href="/assets/js/214.faf266a1.js"><link rel="prefetch" href="/assets/js/215.f6ac9a37.js"><link rel="prefetch" href="/assets/js/216.435d8764.js"><link rel="prefetch" href="/assets/js/217.9fc4df13.js"><link rel="prefetch" href="/assets/js/218.c544c1bc.js"><link rel="prefetch" href="/assets/js/219.b979777a.js"><link rel="prefetch" href="/assets/js/22.9aabaed3.js"><link rel="prefetch" href="/assets/js/220.5e206ed6.js"><link rel="prefetch" href="/assets/js/221.5ec6b7b7.js"><link rel="prefetch" href="/assets/js/222.8ed38f87.js"><link rel="prefetch" href="/assets/js/24.e7e60f38.js"><link rel="prefetch" href="/assets/js/25.4520eed1.js"><link rel="prefetch" href="/assets/js/26.7470b7c1.js"><link rel="prefetch" href="/assets/js/27.1e864c0b.js"><link rel="prefetch" href="/assets/js/28.369d807c.js"><link rel="prefetch" href="/assets/js/29.b50ade3a.js"><link rel="prefetch" href="/assets/js/30.9df714ac.js"><link rel="prefetch" href="/assets/js/31.00f41a65.js"><link rel="prefetch" href="/assets/js/32.e9a11e3b.js"><link rel="prefetch" href="/assets/js/33.7525590b.js"><link rel="prefetch" href="/assets/js/34.fc9ab29a.js"><link rel="prefetch" href="/assets/js/35.181733bf.js"><link rel="prefetch" href="/assets/js/36.35a29b46.js"><link rel="prefetch" href="/assets/js/37.d687885d.js"><link rel="prefetch" href="/assets/js/38.d549f865.js"><link rel="prefetch" href="/assets/js/39.127b7895.js"><link rel="prefetch" href="/assets/js/40.93c670c1.js"><link rel="prefetch" href="/assets/js/41.5e5c1fd3.js"><link rel="prefetch" href="/assets/js/42.0ac32d25.js"><link rel="prefetch" href="/assets/js/43.793cde42.js"><link rel="prefetch" href="/assets/js/44.d03897a2.js"><link rel="prefetch" href="/assets/js/45.0504d395.js"><link rel="prefetch" href="/assets/js/46.53e22546.js"><link rel="prefetch" href="/assets/js/47.236382bf.js"><link rel="prefetch" href="/assets/js/48.914e5900.js"><link rel="prefetch" href="/assets/js/49.e25e2583.js"><link rel="prefetch" href="/assets/js/5.60326d16.js"><link rel="prefetch" href="/assets/js/50.a61abd19.js"><link rel="prefetch" href="/assets/js/51.fd0c9a1a.js"><link rel="prefetch" href="/assets/js/52.388a7bc4.js"><link rel="prefetch" href="/assets/js/53.b5c1f6b4.js"><link rel="prefetch" href="/assets/js/54.5ef8dbf0.js"><link rel="prefetch" href="/assets/js/55.617c4ef1.js"><link rel="prefetch" href="/assets/js/56.beb5f81d.js"><link rel="prefetch" href="/assets/js/57.5d663d4d.js"><link rel="prefetch" href="/assets/js/58.8b97ec44.js"><link rel="prefetch" href="/assets/js/59.2b976818.js"><link rel="prefetch" href="/assets/js/6.c616dc5b.js"><link rel="prefetch" href="/assets/js/60.f251ac6a.js"><link rel="prefetch" href="/assets/js/61.3daaa226.js"><link rel="prefetch" href="/assets/js/62.3c82f971.js"><link rel="prefetch" href="/assets/js/63.4e416cf8.js"><link rel="prefetch" href="/assets/js/64.505e18f9.js"><link rel="prefetch" href="/assets/js/65.c6f765ba.js"><link rel="prefetch" href="/assets/js/66.655ee046.js"><link rel="prefetch" href="/assets/js/67.4c98b7fc.js"><link rel="prefetch" href="/assets/js/68.2da293d8.js"><link rel="prefetch" href="/assets/js/69.f5a00707.js"><link rel="prefetch" href="/assets/js/7.3cb34f5d.js"><link rel="prefetch" href="/assets/js/70.8c813e01.js"><link rel="prefetch" href="/assets/js/71.baf8abb8.js"><link rel="prefetch" href="/assets/js/72.4da7b859.js"><link rel="prefetch" href="/assets/js/73.6a8d8518.js"><link rel="prefetch" href="/assets/js/74.1823c65d.js"><link rel="prefetch" href="/assets/js/75.71586001.js"><link rel="prefetch" href="/assets/js/76.f1b4ead4.js"><link rel="prefetch" href="/assets/js/77.0d84596e.js"><link rel="prefetch" href="/assets/js/78.8bdc11bf.js"><link rel="prefetch" href="/assets/js/79.0a3a031c.js"><link rel="prefetch" href="/assets/js/8.6064bfbe.js"><link rel="prefetch" href="/assets/js/80.558249f5.js"><link rel="prefetch" href="/assets/js/81.fbcd2232.js"><link rel="prefetch" href="/assets/js/82.e4dee4a2.js"><link rel="prefetch" href="/assets/js/83.e7f42d12.js"><link rel="prefetch" href="/assets/js/84.29b662d6.js"><link rel="prefetch" href="/assets/js/85.d31b07ee.js"><link rel="prefetch" href="/assets/js/86.6df71b48.js"><link rel="prefetch" href="/assets/js/87.1b6a3719.js"><link rel="prefetch" href="/assets/js/88.6d2a83e1.js"><link rel="prefetch" href="/assets/js/89.6595bbd8.js"><link rel="prefetch" href="/assets/js/9.bc4b2065.js"><link rel="prefetch" href="/assets/js/90.6af712a6.js"><link rel="prefetch" href="/assets/js/91.ae433643.js"><link rel="prefetch" href="/assets/js/92.8edd08ec.js"><link rel="prefetch" href="/assets/js/93.2e683935.js"><link rel="prefetch" href="/assets/js/94.73f3882d.js"><link rel="prefetch" href="/assets/js/95.08b1742d.js"><link rel="prefetch" href="/assets/js/96.1cc353a3.js"><link rel="prefetch" href="/assets/js/97.40c6088e.js"><link rel="prefetch" href="/assets/js/98.724a2646.js"><link rel="prefetch" href="/assets/js/99.35c9233b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.69fafbdc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.png" alt="离线笔记 · OfflineNotes" class="logo"> <span class="site-name can-hide">离线笔记 · OfflineNotes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">📚 学习</a></div><div class="nav-item"><a href="/manual/" class="nav-link">📖 手册</a></div><div class="nav-item"><a href="/blog/" class="nav-link">🐱‍👓 博客</a></div> <a href="https://github.com/canwdev/notes-vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">📚 学习</a></div><div class="nav-item"><a href="/manual/" class="nav-link">📖 手册</a></div><div class="nav-item"><a href="/blog/" class="nav-link">🐱‍👓 博客</a></div> <a href="https://github.com/canwdev/notes-vuepress" target="_blank" rel="noopener noreferrer" class="repo-link">
    源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p title="学习笔记" class="sidebar-heading"><span>学习笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p title="合格前端自检笔记" class="sidebar-heading open"><span>合格前端自检笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/fe-self-check/" aria-current="page" title="合格前端自检笔记" class="sidebar-link">合格前端自检笔记</a></li><li><a href="/notes/fe-self-check/chapter-01-js-base.html" aria-current="page" title="1. JavaScript基础" class="active sidebar-link">1. JavaScript基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#变量和类型" title="—— 变量和类型 ——" class="sidebar-link">—— 变量和类型 ——</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_1-javascript-规定了几种语言类型" title="1. JavaScript 规定了几种语言类型" class="sidebar-link">1. JavaScript 规定了几种语言类型</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_2-javascript-对象的底层数据结构是什么" title="2. JavaScript 对象的底层数据结构是什么" class="sidebar-link">2. JavaScript 对象的底层数据结构是什么</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_3-symbol-类型在实际开发中的应用、可动手实现一个简单的-symbol" title="3. Symbol 类型在实际开发中的应用、可动手实现一个简单的 Symbol" class="sidebar-link">3. Symbol 类型在实际开发中的应用、可动手实现一个简单的 Symbol</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_4-javascript中的变量在内存中的具体存储形式" title="4. JavaScript中的变量在内存中的具体存储形式" class="sidebar-link">4. JavaScript中的变量在内存中的具体存储形式</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_5-基本类型对应的内置对象-以及他们之间的装箱拆箱操作" title="5. 基本类型对应的内置对象，以及他们之间的装箱拆箱操作" class="sidebar-link">5. 基本类型对应的内置对象，以及他们之间的装箱拆箱操作</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_6-理解值类型和引用类型" title="6. 理解值类型和引用类型" class="sidebar-link">6. 理解值类型和引用类型</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_7-null-和-undefined-的区别" title="7. null 和 undefined 的区别" class="sidebar-link">7. null 和 undefined 的区别</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_8-至少可以说出三种判断-javascript-数据类型的方式-以及他们的优缺点-如何准确的判断数组的类型" title="8. 至少可以说出三种判断 JavaScript 数据类型的方式，以及他们的优缺点，如何准确的判断数组的类型" class="sidebar-link">8. 至少可以说出三种判断 JavaScript 数据类型的方式，以及他们的优缺点，如何准确的判断数组的类型</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_9-可能发生隐式转换的场景以及转换规则-应如何避免或巧妙应用" title="9. 可能发生隐式转换的场景以及转换规则，应如何避免或巧妙应用" class="sidebar-link">9. 可能发生隐式转换的场景以及转换规则，应如何避免或巧妙应用</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_10-出现小数精度丢失的原因-javascript-可以存储的最大数字、最大安全数字-javascript处理大数字的方法、避免精度丢失的方法" title="10. 出现小数精度丢失的原因，JavaScript 可以存储的最大数字、最大安全数字，JavaScript处理大数字的方法、避免精度丢失的方法" class="sidebar-link">10. 出现小数精度丢失的原因，JavaScript 可以存储的最大数字、最大安全数字，JavaScript处理大数字的方法、避免精度丢失的方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#原型和原型链" title="—— 原型和原型链 ——" class="sidebar-link">—— 原型和原型链 ——</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_1-理解原型设计模式以及-javascript-中的原型规则" title="1. 理解原型设计模式以及 JavaScript 中的原型规则" class="sidebar-link">1. 理解原型设计模式以及 JavaScript 中的原型规则</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_2-instanceof-的底层实现原理-手动实现一个-instanceof" title="2. instanceof 的底层实现原理，手动实现一个 instanceof" class="sidebar-link">2. instanceof 的底层实现原理，手动实现一个 instanceof</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_4-实现继承的几种方式以及他们的优缺点" title="4. 实现继承的几种方式以及他们的优缺点" class="sidebar-link">4. 实现继承的几种方式以及他们的优缺点</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_5-至少说出一种开源项目-如node-中应用原型继承的案例" title="5. 至少说出一种开源项目(如Node)中应用原型继承的案例" class="sidebar-link">5. 至少说出一种开源项目(如Node)中应用原型继承的案例</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_6-可以描述new一个对象的详细过程-手动实现一个new操作符" title="6. 可以描述new一个对象的详细过程，手动实现一个new操作符" class="sidebar-link">6. 可以描述new一个对象的详细过程，手动实现一个new操作符</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_7-理解es6-class构造以及继承的底层实现原理" title="7. 理解es6 class构造以及继承的底层实现原理" class="sidebar-link">7. 理解es6 class构造以及继承的底层实现原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#作用域和闭包" title="—— 作用域和闭包 ——" class="sidebar-link">—— 作用域和闭包 ——</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_1-理解词法作用域和动态作用域" title="1.理解词法作用域和动态作用域" class="sidebar-link">1.理解词法作用域和动态作用域</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_2-理解javascript的作用域和作用域链" title="2.理解JavaScript的作用域和作用域链" class="sidebar-link">2.理解JavaScript的作用域和作用域链</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_3-理解javascript的执行上下文栈-可以应用堆栈信息快速定位问题" title="3.理解JavaScript的执行上下文栈，可以应用堆栈信息快速定位问题" class="sidebar-link">3.理解JavaScript的执行上下文栈，可以应用堆栈信息快速定位问题</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_4-this的原理以及几种不同使用场景的取值" title="4.this的原理以及几种不同使用场景的取值" class="sidebar-link">4.this的原理以及几种不同使用场景的取值</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_5-闭包的实现原理和作用-可以列举几个开发中闭包的实际应用" title="5.闭包的实现原理和作用，可以列举几个开发中闭包的实际应用" class="sidebar-link">5.闭包的实现原理和作用，可以列举几个开发中闭包的实际应用</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_6-理解堆栈溢出和内存泄漏的原理-如何防止" title="6.理解堆栈溢出和内存泄漏的原理，如何防止" class="sidebar-link">6.理解堆栈溢出和内存泄漏的原理，如何防止</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_7-如何处理循环的异步操作" title="7.如何处理循环的异步操作" class="sidebar-link">7.如何处理循环的异步操作</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_8-理解模块化解决的实际问题-可列举几个模块化方案并理解其中原理" title="8.理解模块化解决的实际问题，可列举几个模块化方案并理解其中原理" class="sidebar-link">8.理解模块化解决的实际问题，可列举几个模块化方案并理解其中原理</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#执行机制" title="—— 执行机制 ——" class="sidebar-link">—— 执行机制 ——</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_1-为何try里面放return-finally还会执行-理解其内部机制" title="1.为何try里面放return，finally还会执行，理解其内部机制" class="sidebar-link">1.为何try里面放return，finally还会执行，理解其内部机制</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_2-javascript如何实现异步编程-可以详细描述eventloop机制" title="2.JavaScript如何实现异步编程，可以详细描述EventLoop机制" class="sidebar-link">2.JavaScript如何实现异步编程，可以详细描述EventLoop机制</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_3-宏任务和微任务分别有哪些" title="3.宏任务和微任务分别有哪些" class="sidebar-link">3.宏任务和微任务分别有哪些</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_4-可以快速分析一个复杂的异步嵌套逻辑-并掌握分析方法" title="4.可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法" class="sidebar-link">4.可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_5-使用promise实现串行" title="5.使用Promise实现串行" class="sidebar-link">5.使用Promise实现串行</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_6-node与浏览器eventloop的差异" title="6.Node与浏览器EventLoop的差异" class="sidebar-link">6.Node与浏览器EventLoop的差异</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_7-如何在保证页面运行流畅的情况下处理海量数据" title="7.如何在保证页面运行流畅的情况下处理海量数据" class="sidebar-link">7.如何在保证页面运行流畅的情况下处理海量数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#语法和api" title="—— 语法和API ——" class="sidebar-link">—— 语法和API ——</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_1-理解ecmascript和javascript的关系" title="1.理解ECMAScript和JavaScript的关系" class="sidebar-link">1.理解ECMAScript和JavaScript的关系</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_2-熟练运用es5、es6提供的语法规范" title="2.熟练运用es5、es6提供的语法规范，" class="sidebar-link">2.熟练运用es5、es6提供的语法规范，</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_3-熟练掌握javascript提供的全局对象-例如date、math-、全局函数-例如decodeuri、isnan-、全局属性-例如infinity、undefined" title="3.熟练掌握JavaScript提供的全局对象（例如Date、Math）、全局函数（例如decodeURI、isNaN）、全局属性（例如Infinity、undefined）" class="sidebar-link">3.熟练掌握JavaScript提供的全局对象（例如Date、Math）、全局函数（例如decodeURI、isNaN）、全局属性（例如Infinity、undefined）</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_4-熟练应用map、reduce、filter-等高阶函数解决问题" title="4.熟练应用map、reduce、filter 等高阶函数解决问题" class="sidebar-link">4.熟练应用map、reduce、filter 等高阶函数解决问题</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_5-setinterval需要注意的点-使用settimeout实现setinterval" title="5.setInterval需要注意的点，使用setTimeout实现setInterval" class="sidebar-link">5.setInterval需要注意的点，使用setTimeout实现setInterval</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_6-javascript提供的正则表达式api、可以使用正则表达式-邮箱校验、url解析、去重等-解决常见问题" title="6.JavaScript提供的正则表达式API、可以使用正则表达式（邮箱校验、URL解析、去重等）解决常见问题" class="sidebar-link">6.JavaScript提供的正则表达式API、可以使用正则表达式（邮箱校验、URL解析、去重等）解决常见问题</a></li><li class="sidebar-sub-header"><a href="/notes/fe-self-check/chapter-01-js-base.html#_7-javascript异常处理的方式-统一的异常处理方案" title="7.JavaScript异常处理的方式，统一的异常处理方案" class="sidebar-link">7.JavaScript异常处理的方式，统一的异常处理方案</a></li></ul></li></ul></li><li><a href="/notes/fe-self-check/chapter-02-html-css.html" title="2. HTML和CSS" class="sidebar-link">2. HTML和CSS</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p title="前端面试 3+1 &amp; 答案整理" class="sidebar-heading"><span>前端面试 3+1 &amp; 答案整理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p title="Vue 248+ 面试题 &amp; 答案总结" class="sidebar-heading"><span>Vue 248+ 面试题 &amp; 答案总结</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p title="前端面试题（2018.6）" class="sidebar-heading"><span>前端面试题（2018.6）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p title="JavaScript 高程笔记" class="sidebar-heading"><span>JavaScript 高程笔记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-javascript基础"><a href="#_1-javascript基础" class="header-anchor">#</a> 1. JavaScript基础</h1> <h2 id="变量和类型"><a href="#变量和类型" class="header-anchor">#</a> —— 变量和类型 ——</h2> <h3 id="_1-javascript-规定了几种语言类型"><a href="#_1-javascript-规定了几种语言类型" class="header-anchor">#</a> 1. JavaScript 规定了几种语言类型</h3> <ul><li>基本类型：<code>Number</code>, <code>Boolean</code>, <code>String</code>, <code>null</code>, <code>undefined</code>, <code>Symbol</code></li> <li>对象类型：<code>Object</code></li></ul> <h3 id="_2-javascript-对象的底层数据结构是什么"><a href="#_2-javascript-对象的底层数据结构是什么" class="header-anchor">#</a> 2. JavaScript 对象的底层数据结构是什么</h3> <p>对象属于引用类型，底层数据结构为堆</p> <blockquote><p>对象被分配在一个堆中，即用以表示一大块非结构化的内存区域。—— MDN</p></blockquote> <h3 id="_3-symbol-类型在实际开发中的应用、可动手实现一个简单的-symbol"><a href="#_3-symbol-类型在实际开发中的应用、可动手实现一个简单的-symbol" class="header-anchor">#</a> 3. Symbol 类型在实际开发中的应用、可动手实现一个简单的 Symbol</h3> <p>Symbol 类型是 ES6 新增的一种基本类型，主要用途是生成独一无二的值，可用作对象的属性名、定义一组常量或在switch中使用，代替魔术字符串</p> <ul><li><a href="/notes/js/js-symbol.html">ES6 中的 Symbol 类型</a></li> <li><a href="https://juejin.im/post/5b1f4c21f265da6e0f70bb19" target="_blank" rel="noopener noreferrer">ES6 系列之模拟实现 Symbol 类型<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_4-javascript中的变量在内存中的具体存储形式"><a href="#_4-javascript中的变量在内存中的具体存储形式" class="header-anchor">#</a> 4. JavaScript中的变量在内存中的具体存储形式</h3> <p>JS 变量可以分为基本类型和引用类型，基本类型的值存于栈 <code>Stack</code>内存，引用类型的值存于堆 <code>Heap</code> 内存<br> <img src="/assets/img/js-stack-heap.3d3c63c8.png" alt="img"></p> <h3 id="_5-基本类型对应的内置对象-以及他们之间的装箱拆箱操作"><a href="#_5-基本类型对应的内置对象-以及他们之间的装箱拆箱操作" class="header-anchor">#</a> 5. 基本类型对应的内置对象，以及他们之间的装箱拆箱操作</h3> <table><thead><tr><th>基本类型</th> <th>内置对象</th></tr></thead> <tbody><tr><td>123</td> <td>Number</td></tr> <tr><td>true</td> <td>Boolean</td></tr> <tr><td>&quot;abc&quot;</td> <td>String</td></tr></tbody></table> <ul><li>装箱：把基本类型转换为对应的内置对象的操作为装箱</li> <li>拆箱：把内置对象转换为对应的基本类型的操作为拆箱</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token string">'hello world'</span>
<span class="token comment">// 装箱操作</span>
s1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// world</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span>a<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
</code></pre></div><p>上面代码中，<code>s1</code> 是一个基本类型值，不具有方法，JS 通过调用 <code>new String(s1)</code> 转换成对象（装箱），这个对象继承了 <code>substring</code> 方法，所以可以调用，一旦调用（引用）结束，这个新创建的对象就会销毁，由于临时对象销毁，所以访问 <code>s1.a</code> 为 <code>undefined</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span>
   
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> num<span class="token punctuation">)</span> <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> str<span class="token punctuation">)</span> <span class="token comment">// object</span>
   
<span class="token comment">// 拆箱操作</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> num<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// number</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> str<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// string</span>
</code></pre></div><h3 id="_6-理解值类型和引用类型"><a href="#_6-理解值类型和引用类型" class="header-anchor">#</a> 6. 理解值类型和引用类型</h3> <p>值类型保存的是变量的值，而引用类型保存的是变量的地址</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a
a <span class="token operator">=</span> <span class="token number">2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token comment">// 值类型保存的是值，通过修改值不会对其他值类型造成影响</span>
   
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> k<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> obj1
obj1<span class="token punctuation">.</span>k <span class="token operator">=</span> <span class="token number">2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">.</span>k<span class="token punctuation">)</span> <span class="token comment">// 2</span>
<span class="token comment">// 引用类型保存的是引用地址，赋值操作赋值的是引用地址</span>
<span class="token comment">// 修改原有的对象k值时，引用地址并未改变，改变的是k的值</span>
<span class="token comment">// obj2保存的仍然是obj1的地址，所以k也跟着改变</span>
</code></pre></div><h3 id="_7-null-和-undefined-的区别"><a href="#_7-null-和-undefined-的区别" class="header-anchor">#</a> 7. <code>null</code> 和 <code>undefined</code> 的区别</h3> <ul><li><code>null</code> 表示值定义了为<strong>空</strong>值，<code>typeof null</code> 为 <code>&quot;object&quot;</code></li> <li><code>undefined</code> 表示值声明了但<strong>未定义</strong>，<code>typeof undefined</code> 为 <code>&quot;undefined&quot;</code></li></ul> <h3 id="_8-至少可以说出三种判断-javascript-数据类型的方式-以及他们的优缺点-如何准确的判断数组的类型"><a href="#_8-至少可以说出三种判断-javascript-数据类型的方式-以及他们的优缺点-如何准确的判断数组的类型" class="header-anchor">#</a> 8. 至少可以说出三种判断 JavaScript 数据类型的方式，以及他们的优缺点，如何准确的判断<strong>数组</strong>的类型</h3> <p>四种方式：<code>typeof</code>, <code>instanceof</code>, <code>constructor</code>, <code>toString</code></p> <ol><li><p>typeof</p> <p>这种方法可以简单的获取一个变量的数据类型，但不能区分 <code>Array</code> 和 <code>Object</code>，而且有判断 <code>null</code> 值为 <code>&quot;object&quot;</code> 的历史遗留bug。
使用方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token number">123</span> <span class="token comment">// &quot;number&quot;</span>
<span class="token keyword">typeof</span> <span class="token boolean">true</span> <span class="token comment">// &quot;boolean&quot;</span>
<span class="token keyword">typeof</span> <span class="token string">'abc'</span> <span class="token comment">// &quot;string&quot;</span>
<span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// &quot;object&quot;</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// &quot;object&quot;</span>
<span class="token keyword">typeof</span> <span class="token keyword">null</span> <span class="token comment">//&quot;object&quot;</span>
</code></pre></div></li> <li><p>instanceof</p> <p>用来判断 A 是否为 B 的实例，由于 <code>instanceof</code> 检测的是实例，对基本类型无效，且无法检测 <code>null</code> 和 <code>undefined</code> 类型，好处是可以区分 <code>Array</code> 和 <code>Object</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">123</span> <span class="token keyword">instanceof</span> <span class="token class-name">Number</span> <span class="token comment">//false</span>
<span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Number</span> <span class="token comment">// true</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token comment">//true</span>
<span class="token keyword">var</span> obj<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
obj <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token comment">// true</span>
<span class="token string">&quot;abc&quot;</span> <span class="token keyword">instanceof</span> <span class="token class-name">String</span> <span class="token comment">// false</span>
<span class="token boolean">true</span> <span class="token keyword">instanceof</span> <span class="token class-name">Boolean</span> <span class="token comment">// false</span>
</code></pre></div></li> <li><p>constructor</p> <p><code>[].constructor // ƒ Array() { [native code] }</code> 原理和 <code>instanceof</code> 类似，用来获取对象的构造函数，优缺点也与其一样</p></li> <li><p>Object.prototype.toString.call()</p> <p>此为最佳的检测数据类型的方法，使用方式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Number]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Array]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Object]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Null]&quot;</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object Undefined]&quot;</span>
</code></pre></div><p>封装一下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">typeCheck</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> typeStr <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> typeStr<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> typeStr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ol> <p>要准确判断数组的类型，可以使用 ES5 中的 <code>Array.isArray()</code> 方法，或使用上述除了 <code>typeof</code> 的其他方法</p> <h3 id="_9-可能发生隐式转换的场景以及转换规则-应如何避免或巧妙应用"><a href="#_9-可能发生隐式转换的场景以及转换规则-应如何避免或巧妙应用" class="header-anchor">#</a> 9. 可能发生隐式转换的场景以及转换规则，应如何避免或巧妙应用</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">3</span> <span class="token operator">+</span> <span class="token boolean">true</span> <span class="token comment">// 4</span>
<span class="token number">3</span> <span class="token operator">+</span> <span class="token keyword">undefined</span> <span class="token comment">// NaN</span>
<span class="token number">2</span> <span class="token operator">+</span> <span class="token string">'3'</span> <span class="token comment">// 23</span>
<span class="token number">1</span> <span class="token operator">==</span> <span class="token string">'1'</span> <span class="token comment">// true</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token comment">// true</span>
</code></pre></div><p>上述都是常见的隐式转换场景，隐式转换容易造成bug，如何避免：操作数据时先检查数据类型，使用 <code>===</code> 代替 <code>==</code> 可避免判断相等时的隐式转换</p> <h3 id="_10-出现小数精度丢失的原因-javascript-可以存储的最大数字、最大安全数字-javascript处理大数字的方法、避免精度丢失的方法"><a href="#_10-出现小数精度丢失的原因-javascript-可以存储的最大数字、最大安全数字-javascript处理大数字的方法、避免精度丢失的方法" class="header-anchor">#</a> 10. 出现小数精度丢失的原因，JavaScript 可以存储的最大数字、最大安全数字，JavaScript处理大数字的方法、避免精度丢失的方法</h3> <ul><li>众所周知在 JS 中 <code>0.1 + 0.2 // 0.30000000000000004</code>。这是由于 Number 类型采用 <code>IEEE754</code> 规范中64位双精度浮点数编码</li> <li>使用 <code>Number.MAX_SAFE_INTEGER</code> 和 <code>Number.MIN_SAFE_INTEGER</code> 可以分别获取最大和最小安全数字</li> <li>可以先把小数转换成整数再转换成小数的放实来避免精度丢失，或使用 <a href="https://github.com/MikeMcl/big.js/" target="_blank" rel="noopener noreferrer">big.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 库操作数字</li></ul> <hr> <h2 id="原型和原型链"><a href="#原型和原型链" class="header-anchor">#</a> —— 原型和原型链 ——</h2> <h3 id="_1-理解原型设计模式以及-javascript-中的原型规则"><a href="#_1-理解原型设计模式以及-javascript-中的原型规则" class="header-anchor">#</a> 1. 理解原型设计模式以及 JavaScript 中的原型规则</h3> <blockquote><p>参考：<a href="https://juejin.im/post/5ce7cc4451882559ba11549a" target="_blank" rel="noopener noreferrer">js-- 原型设计模式以及JavaScript中的原型规则<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <ul><li><p>原型设计模式</p> <ul><li><a href="/notes/js/js-proto-design-mode.html#工厂模式">工厂模式</a></li> <li><a href="/notes/js/js-proto-design-mode.html#构造函数模式">构造函数模式</a></li> <li><a href="/notes/js/js-proto-design-mode.html#原型模式">原型模式</a></li> <li><a href="/notes/js/js-proto-design-mode.html#混合模式">混合模式</a></li> <li><a href="/notes/js/js-proto-design-mode.html#动态原型模式">动态原型模式</a></li></ul></li> <li><p>原型规则</p> <ul><li>所有的引用类型（数组、对象、函数）都具有对象特征，可自由扩展属性</li> <li>所有的引用类型，都有一个 <code>__proto__</code> 属性（隐式原型），属性值是一个对象</li> <li>所有函数，都有一个 <code>prototype</code> 属性（显式原型），属性值是一个原型</li> <li>所有的引用类型，其隐式原型只想其构造函数的显示原型：<code>obj.__proto__ === Object.prototype</code></li> <li>当试图得到一个对象某个属性时，如果对象本身没有这个属性，就会去它的 <code>__proto__</code>（它的构造函数的 <code>prototype</code>）去寻找，如果找不到，再向上寻找，层层向上寻找就是原型链</li></ul></li></ul> <h3 id="_2-instanceof-的底层实现原理-手动实现一个-instanceof"><a href="#_2-instanceof-的底层实现原理-手动实现一个-instanceof" class="header-anchor">#</a> 2. <code>instanceof</code> 的底层实现原理，手动实现一个 <code>instanceof</code></h3> <p>instanceof 主要用途是判断一个实例是否属于某个对象，通过在实例的原型链上查询 <code>constructor</code>，判断 <code>constructor</code> 与目标对象是否相等来实现此功能</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">instanceOf</span><span class="token punctuation">(</span><span class="token parameter"><span class="token constant">L</span><span class="token punctuation">,</span> <span class="token constant">R</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">L</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">R</span> <span class="token operator">===</span> <span class="token class-name">L</span><span class="token punctuation">.</span>constructor<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token constant">L</span> <span class="token operator">=</span> <span class="token constant">L</span><span class="token punctuation">.</span>__proto__
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">instanceOf</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> Foo<span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token keyword">class</span> <span class="token class-name">Apple</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">var</span> apple <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">instanceOf</span><span class="token punctuation">(</span>apple<span class="token punctuation">,</span> Apple<span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">instanceOf</span><span class="token punctuation">(</span>apple<span class="token punctuation">,</span> Object<span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token function">instanceOf</span><span class="token punctuation">(</span>apple<span class="token punctuation">,</span> Foo<span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><h3 id="_4-实现继承的几种方式以及他们的优缺点"><a href="#_4-实现继承的几种方式以及他们的优缺点" class="header-anchor">#</a> 4. 实现继承的几种方式以及他们的优缺点</h3> <ul><li><a href="/notes/js/js-inherit.html#原型链继承">原型链继承</a></li> <li><a href="/notes/js/js-inherit.html#借用构造函数继承">借用构造函数继承</a></li> <li><a href="/notes/js/js-inherit.html#组合继承">组合继承</a></li> <li><a href="/notes/js/js-inherit.html#原型式继承">原型式继承</a></li> <li><a href="/notes/js/js-inherit.html#寄生式继承">寄生式继承</a></li> <li><a href="/notes/js/js-inherit.html#寄生组合式继承">寄生组合式继承</a></li> <li><a href="/notes/js/js-inherit.html#Class继承">Class继承</a></li></ul> <h3 id="_5-至少说出一种开源项目-如node-中应用原型继承的案例"><a href="#_5-至少说出一种开源项目-如node-中应用原型继承的案例" class="header-anchor">#</a> 5. 至少说出一种开源项目(如<code>Node</code>)中应用原型继承的案例</h3> <p>👀</p> <h3 id="_6-可以描述new一个对象的详细过程-手动实现一个new操作符"><a href="#_6-可以描述new一个对象的详细过程-手动实现一个new操作符" class="header-anchor">#</a> 6. 可以描述new一个对象的详细过程，手动实现一个new操作符</h3> <p><code>new</code> 操作符主要执行了下面3个操作：</p> <ol><li>创建一个空对象，即 <code>{}</code></li> <li>将属性绑定到新创建的对象</li> <li>返回这个对象</li></ol> <p>手动实现一个 <code>new</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">newObject</span><span class="token punctuation">(</span><span class="token parameter">Parent<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
    <span class="token function">Parent</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I am '</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'小明'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span>
p1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token function">newObject</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token string">'小红'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span>
p2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_7-理解es6-class构造以及继承的底层实现原理"><a href="#_7-理解es6-class构造以及继承的底层实现原理" class="header-anchor">#</a> 7. 理解es6 <code>class</code>构造以及继承的底层实现原理</h3> <p>这是一个使用ES6<code>class</code>语法创建的类，可以看作是一个语法糖</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
  <span class="token punctuation">}</span>
  
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中，<code>constructor</code> 构造器等同于 ES5 中的构造函数；<code>class</code> 内部的所有方法（例如<code>toString</code> 方法），都等同于挂载在构造函数的 <code>prototype</code> 属性中的方法。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Point</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 构造函数，等同于 class 中的 constructor</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y
<span class="token punctuation">}</span>
<span class="token class-name">Point</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 等同于 `class` 内部的 `toString`</span>
  <span class="token keyword">return</span> <span class="token string">'('</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token string">', '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token string">')'</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p>class 可以通过 <code>extends</code> 关键字实现继承，如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">ColorPoint</span> <span class="token keyword">extends</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中如果不写 <code>constructor</code> 方法的话，会自动添加，任何子类都有该方法。如果写了 <code>constructor</code> 方法，则必须在其中写上 <code>super()</code> 方法用来调用父类的 <code>constructor</code>，如果不调用 <code>super</code> 方法，创建实例是会报错，子类也得不到 this 对象。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">ColorPoint</span> <span class="token keyword">extends</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用父类的constructor(x, y)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">=</span> color<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>color <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 调用父类的toString()</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ES5 的继承，实质是先创造子类的实例对象 <code>this</code>，再将父类的方法添加到 <code>this</code> 上面（<code>Parent.apply(this)</code>）。ES6 的继承机制完全不同，实质是先将父类的属性方法，添加到 <code>this</code> 上面（所以必须先调用 <code>super</code>），然后再用子类的构造函数修改 <code>this</code>。 —— <a href="http://es6.ruanyifeng.com/#docs/class-extends" target="_blank" rel="noopener noreferrer">《Class 的继承》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <hr> <h2 id="作用域和闭包"><a href="#作用域和闭包" class="header-anchor">#</a> —— 作用域和闭包 ——</h2> <h3 id="_1-理解词法作用域和动态作用域"><a href="#_1-理解词法作用域和动态作用域" class="header-anchor">#</a> 1.理解词法作用域和动态作用域</h3> <ol><li><p>什么是作用域？</p> <p>答：作用域是指程序源代码中定义变量的区域，作用域规定了如何查找变量，也就是确定当前执行代码对变量的访问权限。JavaScript 采用词法作用域，也叫做静态作用域。</p></li> <li><p>静态作用域（词法作用域）和动态作用域的区别？</p> <p>答：词法作用域是再定义函数的时候就决定了的，在函数调用过程中不会改变；而动态作用域则是在函数调用的时候才决定的。</p></li></ol> <p>参考：<a href="https://github.com/mqyqingfeng/Blog/issues/3" target="_blank" rel="noopener noreferrer">JavaScript深入之词法作用域和动态作用域<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_2-理解javascript的作用域和作用域链"><a href="#_2-理解javascript的作用域和作用域链" class="header-anchor">#</a> 2.理解JavaScript的作用域和作用域链</h3> <p><strong>作用域</strong>是指程序源代码中定义变量的区域，作用域规定了如何查找变量，也就是确定当前执行代码对变量的访问权限。JavaScript 采用词法作用域，也叫做静态作用域。</p> <p>当查找变量的时候，会从当前上下文的变量对象中查找，如果没有找到，就会从父级（词法层面上的父级）执行上下文的变量对象中查找，一直找到全局上下文的变量对象（也就是全局对象）。这样由多个执行上下文的变量对象构成的链表就叫做<strong>作用域链</strong>。</p> <p>参考：<a href="https://github.com/yy9306/yy9306.github.io/issues/15" target="_blank" rel="noopener noreferrer">JavaScript深入之作用域链<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_3-理解javascript的执行上下文栈-可以应用堆栈信息快速定位问题"><a href="#_3-理解javascript的执行上下文栈-可以应用堆栈信息快速定位问题" class="header-anchor">#</a> 3.理解JavaScript的执行上下文栈，可以应用堆栈信息快速定位问题</h3> <ol><li>JS 的<strong>可执行代码</strong>的类型由哪些？答：全局代码、函数代码、<code>eval</code>代码。</li> <li>当执行一个函数的时候，引擎会进行准备工作，这里的准备工作就是<strong>执行上下文</strong>。</li> <li>由于代码中会有很多的函数，所以引擎需要管理这些执行上下文，JS 使用**执行上下文栈（Execution Context Stack, ECS）**来管理执行上下文。</li> <li>执行上下文栈是一个<strong>栈</strong>的数据结构，我们可以用数组的<code>push</code>和<code>pop</code>来进行模拟。</li></ol> <p>当 JS 开始解释执行程序代码的时候，首先遇到的就是全局代码，所以初始化的时候首先会向执行上下文栈推入一个全局执行上下文（暂且用globalContext表示），只有当整个程序结束的时候，ECS 才会被清空，在结束前，栈的底部始终都有 globalContext。</p> <div class="language-js extra-class"><pre class="language-js"><code>ECStack <span class="token operator">=</span> <span class="token punctuation">[</span>
    globalContext
<span class="token punctuation">]</span>
</code></pre></div><p><strong>执行上下文栈的工作原理</strong>：当执行一个函数的时候，就会创建一个执行上下文，并且推入执行上下文栈，当函数执行完毕后，就会将函数的执行上下文从栈中弹出</p> <p>假设我们遇到如下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fun3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fun3'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fun3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>那么根据ECS的工作原理，执行过程应该是这样的：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 伪代码</span>

<span class="token comment">// 执行 fun1()</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>fun1<span class="token operator">&gt;</span> functionContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// fun1中竟然调用了fun2，还要创建fun2的执行上下文</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>fun2<span class="token operator">&gt;</span> functionContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 擦，fun2还调用了fun3！</span>
ECStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>fun3<span class="token operator">&gt;</span> functionContext<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// fun3执行完毕</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// fun2执行完毕</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// fun1执行完毕</span>
ECStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// javascript接着执行下面的代码，但是ECStack底层永远有个globalContext。</span>
</code></pre></div><p>参考：[<a href="https://github.com/mqyqingfeng/Blog/issues/4" target="_blank" rel="noopener noreferrer">JavaScript深入之执行上下文栈<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>]</p> <h3 id="_4-this的原理以及几种不同使用场景的取值"><a href="#_4-this的原理以及几种不同使用场景的取值" class="header-anchor">#</a> 4.this的原理以及几种不同使用场景的取值</h3> <p>要科学地理解 <code>this</code> 关键字，我们需要从 <a href="http://yanhaijing.com/es5/" target="_blank" rel="noopener noreferrer">ECMAScript 5 规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 层面开始。</p> <p>首先，ECMAScript 的类型分为语言类型和规范类型（<strong>Reference 类型</strong>）：——第 8 章 Types</p> <ol><li><p>语言类型是开发者可以直接操作的，也就是：Number、String、Boolean、Null、Undefined。</p></li> <li><p>Reference 类型：</p> <blockquote><p>这里的 Reference 是一个 Specification Type，也就是 “只存在于规范里的抽象类型”。它们是为了更好地描述语言的底层行为逻辑才存在的，但并不存在于实际的 js 代码中。 ——尤雨溪</p></blockquote></li></ol> <p>一个 Reference 类型由：<code>base value</code>、<code>referenced name</code>、<code>strict reference</code> 构成。——8.7 引用规范类型</p> <p>例子①：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment">// foo 对应的 Reference 是：</span>
<span class="token keyword">var</span> fooReference <span class="token operator">=</span> <span class="token punctuation">{</span>
    base<span class="token operator">:</span> EnvironmentRecord<span class="token punctuation">,</span> <span class="token comment">// `base value`</span>
    name<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token comment">// `referenced name`</span>
    strice<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// `strict reference` </span>
<span class="token punctuation">}</span>
</code></pre></div><p>例子②：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// this 指向 foo</span>

<span class="token comment">// bar 对应的 Reference 是：</span>
<span class="token keyword">var</span> barReference <span class="token operator">=</span> <span class="token punctuation">{</span>
    base<span class="token operator">:</span> foo<span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
    strict<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>此外，8.7 规范中还定义了一些我们需要的<strong>抽象操作</strong>（只存在于规范中）：</p> <ol><li><p>GetBase(V)</p> <p>返回 Reference 的 <code>base value</code>。</p></li> <li><p>IsPropertyReference(V)</p></li></ol> <p>如果 <code>base value</code> 是一个对象，则返回 <code>true</code>。</p> <ol start="3"><li><p>GetValue(V)</p> <p>返回对象属性真正的值（而不再是 Reference，这很重要）。</p></li></ol> <p>在 11.2 有 <code>MemberExpression</code>（左值表达式）抽象操作，例如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// MemberExpression 是 foo</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// MemberExpression 是 foo()</span>

<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// MemberExpression 是 foo.bar</span>
</code></pre></div><p>所以简单理解 MemberExpression 就是 <code>()</code> 左边的部分。</p> <p>在 10.2.1.1.6 中有 <code>ImplicitThisValue()</code> 抽象操作，该操作始终返回 <code>undefined</code>。</p> <hr> <p>理解了上面的前置知识定义，我们就可以确定<strong>任何情况下</strong> <code>this</code> 的指向了！</p> <p>判断 this 指向的步骤：——  11.2.3 函数调用</p> <ol><li>计算 <code>MemberExpression</code> 的结果，赋值给 <code>ref</code>；</li> <li>判断 <code>ref</code> 是不是一个 Reference 类型：
<ul><li>如果 <code>ref</code> 是 Reference，并且  <code>IsPropertyReference(ref)</code> 是 true，那么 this 的值为 <code>GetBase(ref)</code>。</li> <li>如果 <code>ref</code> 是 Reference，并且 <code>base value</code> 值是 <code>EnvironmentRecord</code>，那么 this 的值为 <code>ImplicitThisValue(ref)</code>。</li> <li>如果 <code>ref</code> 不是 Reference，那么 this 的值为 <code>undefined</code>。</li></ul></li></ol> <blockquote><p>在非严格模式中，this 值为 undefined 时，其值会被隐式转换为全局对象</p></blockquote> <hr> <p>根据上面的步骤，我们来看一个简单的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// this 的值为全局对象</span>
</code></pre></div><ol><li>计算 <code>MemberExpression</code> 的结果，<code>ref</code> = <code>foo</code></li> <li><code>ref</code> 是 Reference 类型，并且 <code>base value</code> 是 <code>EnvironmentRecord</code>，所以 <code>this</code> = <code>ImplicitThisValue(ref)</code>，为 <code>undefined</code>，在非严格模式下指向全局对象。</li></ol> <p>复杂一点的例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token function-variable function">bar</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 下面两个操作，ref是Reference类型，且 IsPropertyReference 为 true，所以 this 指向 bar 的 GetBase(ref) 为 foo。</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>

<span class="token comment">// 下面的三个操作，分别查看规范 11.13.1、11.11、11.14，都执行了 GetValue 抽象操作，GetValue 返回值不是 Reference，所以指向 undefined，非严格模式下为全局对象。</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>bar <span class="token operator">=</span> foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">||</span> foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>foo<span class="token punctuation">.</span>bar<span class="token punctuation">,</span> foo<span class="token punctuation">.</span>bar<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><p>后记：尽管我们可以简单的理解 this 为调用函数的对象（谁调用了函数函数 this 就指向谁），但我们不能通过这个简单的理解去解释上面例子最后的三个操作。所以，从规范层面理解 this 指向是最科学的办法。</p> <p>参考：<a href="https://github.com/mqyqingfeng/Blog/issues/7" target="_blank" rel="noopener noreferrer">JavaScript深入之从ECMAScript规范解读this<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_5-闭包的实现原理和作用-可以列举几个开发中闭包的实际应用"><a href="#_5-闭包的实现原理和作用-可以列举几个开发中闭包的实际应用" class="header-anchor">#</a> 5.闭包的实现原理和作用，可以列举几个开发中闭包的实际应用</h3> <p>MDN 对闭包的定义为：闭包是指那些能够访问自由变量的函数。</p> <p>什么是自由变量？自由变量是指在函数使用中的，但既不是函数参数也不是函数局部变量的变量。</p> <p>所以，<code>闭包 = 函数 + 函数能够访问的自由变量</code>。</p> <p>按照上面的理论，所有的 JS 函数都是闭包，这似乎和我们平常的理解不太一样...</p> <p>所以这里有两个概念：理论上的闭包和实践上的闭包。</p> <ol><li>从理论角度：所有的函数都是闭包。</li> <li>从实践的角度，以下函数才算是闭包：
<ol><li>即使创建它的上下文已经被销毁，它仍然存在（如：内部函数从父函数中返回）。</li> <li>在代码中引用了自由变量。</li></ol></li></ol> <p>闭包的形象例子：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;global scope&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">checkscope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> scope <span class="token operator">=</span> <span class="token string">&quot;local scope&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> scope<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> f<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token function">checkscope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>从我个人角度解释：函数A返回了函数B，即使A被销毁，函数B仍然可以访问函数A作用域中的变量。</p></blockquote> <p>实际应用：</p> <ol><li>函数防抖</li> <li>单例模式</li> <li>设置私有变量</li> <li>for 循环中拿到正确的值</li></ol> <p>参考：</p> <ul><li><a href="https://github.com/mqyqingfeng/Blog/issues/9" target="_blank" rel="noopener noreferrer">JavaScript深入之闭包<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5b1f36e6f265da6e1a603e34" target="_blank" rel="noopener noreferrer">闭包实际场景应用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_6-理解堆栈溢出和内存泄漏的原理-如何防止"><a href="#_6-理解堆栈溢出和内存泄漏的原理-如何防止" class="header-anchor">#</a> 6.理解堆栈溢出和内存泄漏的原理，如何防止</h3> <p>堆栈溢出：是指内存空间已被申请完，没有足够的内存提供了。</p> <p>内存泄漏：是指申请的内存执行完成后没有及时清理或销毁，占用空闲内存，内存泄漏过多就会导致后面的程序申请不到内存，因此内存泄漏会导致内部内存溢出。</p> <p>常见内存泄漏原因：</p> <ol><li>未被清除的计时器和事件监听器——及时清除</li> <li>避免死循环的发生</li></ol> <h3 id="_7-如何处理循环的异步操作"><a href="#_7-如何处理循环的异步操作" class="header-anchor">#</a> 7.如何处理循环的异步操作</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 假设异步操作是这样的</span>
<span class="token keyword">function</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'save'</span><span class="token punctuation">)</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li><p>确保循环的所有异步操作完成之后再执行其他操作</p> <ul><li><p>利用 i，在每个异步操作中对 i 进行检测</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> len <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    flag<span class="token operator">++</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p>循环中的下一步操作依赖于前一步的操作，如何解决</p> <ul><li><p>使用递归</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> len <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">function</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token parameter">i<span class="token operator">=</span><span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
    i<span class="token operator">++</span>
    <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">loop</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'loop'</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>使用 async 和 await</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul></li></ol> <h3 id="_8-理解模块化解决的实际问题-可列举几个模块化方案并理解其中原理"><a href="#_8-理解模块化解决的实际问题-可列举几个模块化方案并理解其中原理" class="header-anchor">#</a> 8.理解模块化解决的实际问题，可列举几个模块化方案并理解其中原理</h3> <p>模块化解决了大型工程的多人写作、代码复用、打包、提升效率、后期维护性等问题。</p> <p>常见模块化方案：</p> <ul><li><p>AMD/CMD：</p> <ul><li><p>AMD：require.js 为代表，依赖前置，一律先加载再使用。</p></li> <li><p>CMD：sea.js 为代表，依赖就近原则。</p></li></ul></li> <li><p>CommonJS —— Node.js 标准中的语法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// utils.js</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> add

<span class="token comment">// index.js</span>
<span class="token keyword">const</span> add <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils'</span><span class="token punctuation">)</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>ES Module —— ES6 的语法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// utils.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>add<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../utils'</span>
</code></pre></div></li></ul> <hr> <h2 id="执行机制"><a href="#执行机制" class="header-anchor">#</a> —— 执行机制 ——</h2> <h3 id="_1-为何try里面放return-finally还会执行-理解其内部机制"><a href="#_1-为何try里面放return-finally还会执行-理解其内部机制" class="header-anchor">#</a> 1.为何try里面放return，finally还会执行，理解其内部机制</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'try'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">'return'</span>
        <span class="token keyword">throw</span> <span class="token string">'抛出错误'</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'catch:'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finally'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>上面的代码，输出结果的顺序是：<code>try -&gt; finally -&gt; return</code>。可见 finally 无论如何都会在结束时执行，并且 finally 比 <strong>return 操作</strong> 更早的执行了。备注：在 catch 中返回的顺序也是一样。</p> <p>如果在 finally 里加一个 return 会怎样？我们看下面代码：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'try'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">'return from try'</span>
        <span class="token keyword">throw</span> <span class="token string">'抛出错误'</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'catch:'</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finally'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">'return from finally'</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>输出顺序是：<code>try -&gt; finally -&gt; return from finally</code> 这说明了 finally 确实比 try 或者 catch 中的 <strong>return 操作</strong>更早的执行了，因为在 finally 中遇到 return，整个函数就真的 return 了。</p> <h3 id="_2-javascript如何实现异步编程-可以详细描述eventloop机制"><a href="#_2-javascript如何实现异步编程-可以详细描述eventloop机制" class="header-anchor">#</a> 2.JavaScript如何实现异步编程，可以详细描述EventLoop机制</h3> <h4 id="js-异步编程"><a href="#js-异步编程" class="header-anchor">#</a> JS 异步编程</h4> <ol><li><p>回调函数（callback）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">f1</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>事件监听</p></li> <li><p>发布/订阅</p></li> <li><p>Promise 对象</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>async/await（异步函数）同步执行</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// f1() 是上面的 Promise 对象</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ol> <h4 id="js-的-event-loop-事件环"><a href="#js-的-event-loop-事件环" class="header-anchor">#</a> JS 的 Event Loop（事件环）</h4> <p>前置知识：</p> <ul><li>JavaScript 是单线程的。</li> <li>堆（heap）：是指程序运行时申请的动态内存，在JS运行时用来存放对象。</li> <li>栈（stack）：遵循先进后出原则，JS 中的基本数据类型和指向对象的地址存放在栈中，此外还有一块栈内存用来执行 JS 主进程——执行上下文栈（Eexcution Context Stack, ECS）。</li> <li>队列（queue）：JS 的单线程意味着所有的任务都要按照一定的规则顺序排队执行，这个规则就是 Event Loop（事件环）。</li> <li><img src="/assets/img/event-loop.8bac4b2b.png" alt="event-loop"></li></ul> <p>Event Loop 的示例（浏览器环境）：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment">// 最终输出结果的顺序：1,2,5,3,4,6,7</span>
</code></pre></div><p>这个示例说明了异步操作需要进入任务队列，并且排队执行。</p> <p>任务队列中的所有任务都会乖乖<s>站好</s>排队吗？答案是否定的。微任务比宏任务有更高的特权，我们看一下代码：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 输出顺序：1,2,promise,3</span>
</code></pre></div><p>如果按照队列排队来分析，输出顺序应该为 1,2,3,promise，但事与愿违。这是因为 promise 是微任务。其实，任务队列有两个，一个是微任务队列，一个是宏任务队列。</p> <p>Event Loop 规则总结：当主线程执行完毕，如果微任务队列中有微任务，则会先进入执行上下文栈，当微任务队列没有任务时，才会执行宏任务队列。</p> <p>参考：</p> <ul><li><a href="https://www.ruanyifeng.com/blog/2012/12/asynchronous%EF%BC%BFjavascript.html" target="_blank" rel="noopener noreferrer">Javascript异步编程的4种方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/post/5aab2d896fb9a028b86dc2fd" target="_blank" rel="noopener noreferrer">JavaScript 运行机制--Event Loop详解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_3-宏任务和微任务分别有哪些"><a href="#_3-宏任务和微任务分别有哪些" class="header-anchor">#</a> 3.宏任务和微任务分别有哪些</h3> <p>（浏览器）</p> <ul><li>微任务包括：原生 Promise、Object.observe（已废弃）、MutationObserver、MessageChannel。</li> <li>宏任务包括：setTimeout、setInterval、setImmediate、I/O操作。</li></ul> <h3 id="_4-可以快速分析一个复杂的异步嵌套逻辑-并掌握分析方法"><a href="#_4-可以快速分析一个复杂的异步嵌套逻辑-并掌握分析方法" class="header-anchor">#</a> 4.可以快速分析一个复杂的异步嵌套逻辑，并掌握分析方法</h3> <p>（参考上述 SyncPool、微任务宏任务）</p> <h3 id="_5-使用promise实现串行"><a href="#_5-使用promise实现串行" class="header-anchor">#</a> 5.使用Promise实现串行</h3> <ul><li><p>方法一：在 then 语句里写下一步操作</p></li> <li><p>方法二：使用 async/await</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sending request...'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></li></ul> <h3 id="_6-node与浏览器eventloop的差异"><a href="#_6-node与浏览器eventloop的差异" class="header-anchor">#</a> 6.Node与浏览器EventLoop的差异</h3> <p>浏览器环境下，微任务的任务队列是每个宏任务执行完之后执行。而在Node.js中，微任务会在事件循环的各个阶段之间执行，也就是一个阶段执行完毕，就会去执行微任务队列的任务。</p> <p><img src="/assets/img/event-loop-browser-node.9d967395.png" alt="差异"></p> <p>浏览器中的 Event Loop 执行过程：</p> <p><img src="/assets/img/event-loop-anim-browser.d1ca0d6b.gif" alt="浏览器"></p> <p>Node.js 中的 Event Loop 执行过程：</p> <p><img src="/assets/img/event-loop-anim-node.963090bd.gif" alt="Node.js"></p> <p>参考：<a href="https://juejin.im/post/5c337ae06fb9a049bc4cd218" target="_blank" rel="noopener noreferrer">浏览器与Node的事件循环(Event Loop)有何区别?<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_7-如何在保证页面运行流畅的情况下处理海量数据"><a href="#_7-如何在保证页面运行流畅的情况下处理海量数据" class="header-anchor">#</a> 7.如何在保证页面运行流畅的情况下处理海量数据</h3> <p>只渲染可见部分，向下滑动实时渲染，或使用分页。</p> <hr> <h2 id="语法和api"><a href="#语法和api" class="header-anchor">#</a> —— 语法和API ——</h2> <h3 id="_1-理解ecmascript和javascript的关系"><a href="#_1-理解ecmascript和javascript的关系" class="header-anchor">#</a> 1.理解ECMAScript和JavaScript的关系</h3> <p><strong>ECMAScript</strong>是一种由<a href="https://zh.wikipedia.org/wiki/Ecma%E5%9B%BD%E9%99%85" target="_blank" rel="noopener noreferrer">Ecma国际<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>在标准ECMA-262中定义的脚本语言规范。JavaScript 是ECMA-262标准的实现和扩展。</p> <p>我们常说的ES5、ES6，就是不同的 <strong>ECMAScript</strong> 的版本</p> <ul><li>ES5.1 在 2011年6月发表</li> <li>ES6（ES2015），在2015年6月发表</li> <li>ES7（ES2016），在2016年6月发表</li> <li>... 后续版本以此类推</li> <li>目前最新版为 ES10（ES2019）在2019年6月发表</li></ul> <h3 id="_2-熟练运用es5、es6提供的语法规范"><a href="#_2-熟练运用es5、es6提供的语法规范" class="header-anchor">#</a> 2.熟练运用es5、es6提供的语法规范，</h3> <p>推荐如下书籍：</p> <ul><li>《JavaScript 高级程序设计》（简称：高程/红宝书，ES5）</li> <li>《JavaScript 权威指南》（简称：犀牛书，ES5）</li> <li><a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener noreferrer">《ECMAScript 6 入门》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_3-熟练掌握javascript提供的全局对象-例如date、math-、全局函数-例如decodeuri、isnan-、全局属性-例如infinity、undefined"><a href="#_3-熟练掌握javascript提供的全局对象-例如date、math-、全局函数-例如decodeuri、isnan-、全局属性-例如infinity、undefined" class="header-anchor">#</a> 3.熟练掌握JavaScript提供的全局对象（例如Date、Math）、全局函数（例如decodeURI、isNaN）、全局属性（例如Infinity、undefined）</h3> <p>（略）</p> <h3 id="_4-熟练应用map、reduce、filter-等高阶函数解决问题"><a href="#_4-熟练应用map、reduce、filter-等高阶函数解决问题" class="header-anchor">#</a> 4.熟练应用map、reduce、filter 等高阶函数解决问题</h3> <ul><li>map 用于遍历数组</li> <li>reduce 用于累加（或者处理）数组各项</li> <li>filter 用于过滤数组项目</li></ul> <h3 id="_5-setinterval需要注意的点-使用settimeout实现setinterval"><a href="#_5-setinterval需要注意的点-使用settimeout实现setinterval" class="header-anchor">#</a> 5.setInterval需要注意的点，使用setTimeout实现setInterval</h3> <p>setInterval的参数，除了基本的前面两个参数外，还支持这样写 <code>setInterval(func, delay, [arg1, arg2, ...])</code> 剩下的参数会被传入到 func 函数中。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> intervalID <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>myCallback<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">'Parameter 1'</span><span class="token punctuation">,</span> <span class="token string">'Parameter 2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">myCallback</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用setTimeout实现setInterval：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">MyInterval</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    
    <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>run<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">stop</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> it <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyInterval</span><span class="token punctuation">(</span>log<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_6-javascript提供的正则表达式api、可以使用正则表达式-邮箱校验、url解析、去重等-解决常见问题"><a href="#_6-javascript提供的正则表达式api、可以使用正则表达式-邮箱校验、url解析、去重等-解决常见问题" class="header-anchor">#</a> 6.JavaScript提供的正则表达式API、可以使用正则表达式（邮箱校验、URL解析、去重等）解决常见问题</h3> <p>创建 RegExp 对象：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token regex">/ab+c/i</span>
<span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;ab+c&quot;</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token regex">/ab+c/</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span>
</code></pre></div><p>RegExp 常用实例属性：</p> <ul><li>global</li> <li>ignoreCase</li> <li>lastIndex</li> <li>multiline</li></ul> <p>RegExp 常用方法：</p> <ul><li>exec()</li> <li>test()</li></ul> <p>字符串常用正则方法：</p> <ul><li>replace()</li> <li>match()</li></ul> <blockquote><p>完整的API，参考：<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp" target="_blank" rel="noopener noreferrer">MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>邮箱校验：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex">/^(([^&lt;&gt;()\[\]\\.,;:\s@&quot;]+(\.[^&lt;&gt;()\[\]\\.,;:\s@&quot;]+)*)|(&quot;.+&quot;))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/</span>
reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'text@example.com'</span><span class="token punctuation">)</span>
</code></pre></div><p>URL 解析：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 判断是否 URL</span>
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex">/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&amp;=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&amp;=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&amp;;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/</span>
reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'https://example.com'</span><span class="token punctuation">)</span>
</code></pre></div><p>字符串去重：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">&quot;sadadfhdddddddddddasasdjl&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex">/(.)(.*?)(\1)/g</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    str <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> <span class="token string">&quot;$1$2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
</code></pre></div><h3 id="_7-javascript异常处理的方式-统一的异常处理方案"><a href="#_7-javascript异常处理的方式-统一的异常处理方案" class="header-anchor">#</a> 7.JavaScript异常处理的方式，统一的异常处理方案</h3> <p>使用 <code>try {} catch (e) {}</code> 语句捕获错误。</p> <p>统一收集前端错误：</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">errorEvent</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>errorEvent<span class="token punctuation">)</span>
    cosnole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>errorEvent<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre></div><p>参考：<a href="https://juejin.im/post/5be2b0f6e51d4523161b92f0" target="_blank" rel="noopener noreferrer">前端错误收集以及统一异常处理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/canwdev/notes-vuepress/edit/master/docs/notes/fe-self-check/chapter-01-js-base.md" target="_blank" rel="noopener noreferrer">查看本页源码</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">Tue, 22 Sep 2020 10:38:32 GMT</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes/fe-self-check/" class="prev router-link-active">合格前端自检笔记</a></span> <span class="next"><a href="/notes/fe-self-check/chapter-02-html-css.html">2. HTML和CSS</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.52c11373.js" defer></script><script src="/assets/js/3.8898b206.js" defer></script><script src="/assets/js/4.fadcc5fc.js" defer></script><script src="/assets/js/14.91686631.js" defer></script><script src="/assets/js/23.85ba7bbb.js" defer></script>
  </body>
</html>
